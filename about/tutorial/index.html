<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/0.09f28b79d70afdbe25ce.css">@font-face{font-family:Roboto;font-style:normal;font-display:swap;font-weight:100;src:local("Roboto Thin "),local("Roboto-Thin"),url(/static/roboto-latin-100-987b84570ea69ee660455b8d5e91f5f1.woff2) format("woff2"),url(/static/roboto-latin-100-e9dbbe8a693dd275c16d32feb101f1c1.woff) format("woff")}@font-face{font-family:Roboto;font-style:italic;font-display:swap;font-weight:100;src:local("Roboto Thin italic"),local("Roboto-Thinitalic"),url(/static/roboto-latin-100italic-6232f43d15b0e7a0bf0fe82e295bdd06.woff2) format("woff2"),url(/static/roboto-latin-100italic-d704bb3d579b7d5e40880c75705c8a71.woff) format("woff")}@font-face{font-family:Roboto;font-style:normal;font-display:swap;font-weight:300;src:local("Roboto Light "),local("Roboto-Light"),url(/static/roboto-latin-300-55536c8e9e9a532651e3cf374f290ea3.woff2) format("woff2"),url(/static/roboto-latin-300-a1471d1d6431c893582a5f6a250db3f9.woff) format("woff")}@font-face{font-family:Roboto;font-style:italic;font-display:swap;font-weight:300;src:local("Roboto Light italic"),local("Roboto-Lightitalic"),url(/static/roboto-latin-300italic-d69924b98acd849cdeba9fbff3f88ea6.woff2) format("woff2"),url(/static/roboto-latin-300italic-210a7c781f5a354a0e4985656ab456d9.woff) format("woff")}@font-face{font-family:Roboto;font-style:normal;font-display:swap;font-weight:400;src:local("Roboto Regular "),local("Roboto-Regular"),url(/static/roboto-latin-400-5d4aeb4e5f5ef754e307d7ffaef688bd.woff2) format("woff2"),url(/static/roboto-latin-400-bafb105baeb22d965c70fe52ba6b49d9.woff) format("woff")}@font-face{font-family:Roboto;font-style:italic;font-display:swap;font-weight:400;src:local("Roboto Regular italic"),local("Roboto-Regularitalic"),url(/static/roboto-latin-400italic-d8bcbe724fd6f4ba44d0ee6a2675890f.woff2) format("woff2"),url(/static/roboto-latin-400italic-9680d5a0c32d2fd084e07bbc4c8b2923.woff) format("woff")}@font-face{font-family:Roboto;font-style:normal;font-display:swap;font-weight:500;src:local("Roboto Medium "),local("Roboto-Medium"),url(/static/roboto-latin-500-285467176f7fe6bb6a9c6873b3dad2cc.woff2) format("woff2"),url(/static/roboto-latin-500-de8b7431b74642e830af4d4f4b513ec9.woff) format("woff")}@font-face{font-family:Roboto;font-style:italic;font-display:swap;font-weight:500;src:local("Roboto Medium italic"),local("Roboto-Mediumitalic"),url(/static/roboto-latin-500italic-510dec37fa69fba39593e01a469ee018.woff2) format("woff2"),url(/static/roboto-latin-500italic-ffcc050b2d92d4b14a4fcb527ee0bcc8.woff) format("woff")}@font-face{font-family:Roboto;font-style:normal;font-display:swap;font-weight:700;src:local("Roboto Bold "),local("Roboto-Bold"),url(/static/roboto-latin-700-037d830416495def72b7881024c14b7b.woff2) format("woff2"),url(/static/roboto-latin-700-cf6613d1adf490972c557a8e318e0868.woff) format("woff")}@font-face{font-family:Roboto;font-style:italic;font-display:swap;font-weight:700;src:local("Roboto Bold italic"),local("Roboto-Bolditalic"),url(/static/roboto-latin-700italic-010c1aeee3c6d1cbb1d5761d80353823.woff2) format("woff2"),url(/static/roboto-latin-700italic-846d1890aee87fde5d8ced8eba360c3a.woff) format("woff")}@font-face{font-family:Roboto;font-style:normal;font-display:swap;font-weight:900;src:local("Roboto Black "),local("Roboto-Black"),url(/static/roboto-latin-900-19b7a0adfdd4f808b53af7e2ce2ad4e5.woff2) format("woff2"),url(/static/roboto-latin-900-8c2ade503b34e31430d6c98aa29a52a3.woff) format("woff")}@font-face{font-family:Roboto;font-style:italic;font-display:swap;font-weight:900;src:local("Roboto Black italic"),local("Roboto-Blackitalic"),url(/static/roboto-latin-900italic-7b770d6c53423deb1a8e49d3c9175184.woff2) format("woff2"),url(/static/roboto-latin-900italic-bc833e725c137257c2c42a789845d82f.woff) format("woff")}code[class*=language-],pre[class*=language-]{color:#ccc;background:none;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto}:not(pre)>code[class*=language-],pre[class*=language-]{background:#2d2d2d}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal}.token.block-comment,.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#999}.token.punctuation{color:#ccc}.token.attr-name,.token.deleted,.token.namespace,.token.tag{color:#e2777a}.token.function-name{color:#6196cc}.token.boolean,.token.function,.token.number{color:#f08d49}.token.class-name,.token.constant,.token.property,.token.symbol{color:#f8c555}.token.atrule,.token.builtin,.token.important,.token.keyword,.token.selector{color:#cc99cd}.token.attr-value,.token.char,.token.regex,.token.string,.token.variable{color:#7ec699}.token.entity,.token.operator,.token.url{color:#67cdcc}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}.token.inserted{color:green}</style><meta name="generator" content="Gatsby 2.0.8"/><style id="glamor-styles">.css-1bkrl30,[data-css-1bkrl30]{position:relative;margin:0;padding-left:250px;}@media (max-width: 980px){.css-1bkrl30,[data-css-1bkrl30]{padding-left:0;}}.css-d35p82,[data-css-d35p82]{position:fixed;top:0;height:100vh;left:0;width:250px;overflow:auto;}.css-d35p82> *,[data-css-d35p82]> *{overflow:auto;}@media (max-width: 980px){.css-d35p82,[data-css-d35p82]{left:-250px;}}</style><script id="glamor-ids">
        // <![CDATA[
        window._glamor = ["1bkrl30","d35p82"]
        // ]]>
        </script><title data-react-helmet="true">NIKITA - Tutorial</title><meta data-react-helmet="true" name="description" content="Instructions on how to get up and running"/><meta data-react-helmet="true" name="keywords"/><style type="text/css">
    .anchor {
      float: left;
      padding-right: 4px;
      margin-left: -20px;
    }
    h1 .anchor svg,
    h2 .anchor svg,
    h3 .anchor svg,
    h4 .anchor svg,
    h5 .anchor svg,
    h6 .anchor svg {
      visibility: hidden;
    }
    h1:hover .anchor svg,
    h2:hover .anchor svg,
    h3:hover .anchor svg,
    h4:hover .anchor svg,
    h5:hover .anchor svg,
    h6:hover .anchor svg,
    h1 .anchor:focus svg,
    h2 .anchor:focus svg,
    h3 .anchor:focus svg,
    h4 .anchor:focus svg,
    h5 .anchor:focus svg,
    h6 .anchor:focus svg {
      visibility: visible;
    }
  </style><script>
    document.addEventListener("DOMContentLoaded", function(event) {
      var hash = window.decodeURI(location.hash.replace('#', ''))
      if (hash !== '') {
        var element = document.getElementById(hash)
        if (element) {
          var offset = element.offsetTop
          // Wait for the browser to finish rendering before scrolling.
          setTimeout((function() {
            window.scrollTo(0, offset - 64)
          }), 0)
        }
      }
    })
  </script><link rel="shortcut icon" href="/icons/icon-48x48.png"/><link rel="manifest" href="/manifest.webmanifest"/><meta name="theme-color" content="#105859"/><link as="script" rel="preload" href="/1-a9b23d1071238c1862cc.js"/><link as="script" rel="preload" href="/component---src-templates-template-js-7b0e122e1339e36ee047.js"/><link as="script" rel="preload" href="/app-81426d799bfa5e36a8dc.js"/><link as="script" rel="preload" href="/0-d91fd67f8e6efc633636.js"/><link as="script" rel="preload" href="/webpack-runtime-cfdb1e99316333a36b8d.js"/><link rel="preload" href="/static/d/622/path---about-tutorial-ef-9-ee9-Zec8UUI5Jagwcq61N6DFOm4V8.json" as="fetch" crossOrigin="use-credentials"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" role="group"><div class="jss1"><div class="css-1bkrl30"><header class="jss18 jss24 jss9 jss10 jss16 mui-fixed jss3 jss4"><div class="jss45 jss47 jss46"><button tabindex="0" class="jss55 jss49 jss50 jss8" type="button" aria-label="open drawer"><span class="jss54"><svg class="jss58" focusable="false" viewBox="0 0 24 24" aria-hidden="true" role="presentation"><path fill="none" d="M0 0h24v24H0z"></path><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"></path></svg></span><span class="jss67"></span></button><a href="/"><p class="jss74 jss83 jss94 jss91 jss6">Nikita<svg class="jss58 jss5" focusable="false" viewBox="0 0 24 24" aria-hidden="true" role="presentation"><g><path d=" M 7.307 6.867 L 10.46 6.867 C 10.703 6.867 10.9 7.064 10.9 7.307 L 10.9 12.293 C 10.9 12.536 11.097 12.733 11.34 12.733 L 14.86 12.733 C 15.103 12.733 15.3 12.93 15.3 13.173 L 15.3 18.16 C 15.3 18.403 15.103 18.6 14.86 18.6 L 7.307 18.6 C 7.064 18.6 6.867 18.403 6.867 18.16 L 6.867 7.307 C 6.867 7.064 7.064 6.867 7.307 6.867 Z "></path><path d=" M 12.367 4.373 L 12.367 10.827 C 12.367 11.07 12.564 11.267 12.807 11.267 L 18.16 11.267 C 18.403 11.267 18.6 11.07 18.6 10.827 L 18.6 4.373 C 18.6 4.13 18.403 3.933 18.16 3.933 L 12.807 3.933 C 12.564 3.933 12.367 4.13 12.367 4.373 Z "></path><path d=" M 16.767 14.64 L 16.767 19.627 C 16.767 19.87 16.57 20.067 16.327 20.067 L 11.34 20.067 C 11.097 20.067 10.9 20.264 10.9 20.507 L 10.9 22.56 C 10.9 22.803 11.097 23 11.34 23 L 19.26 23 C 19.503 23 19.7 22.803 19.7 22.56 L 19.7 14.64 C 19.7 14.397 19.503 14.2 19.26 14.2 L 17.207 14.2 C 16.964 14.2 16.767 14.397 16.767 14.64 Z "></path><path d=" M 9.8 20.507 L 9.8 21.093 C 9.8 21.336 9.603 21.533 9.36 21.533 L 4.373 21.533 C 4.13 21.533 3.933 21.336 3.933 21.093 L 3.933 14.64 C 3.933 14.397 4.13 14.2 4.373 14.2 L 4.96 14.2 C 5.203 14.2 5.4 14.397 5.4 14.64 L 5.4 19.627 C 5.4 19.87 5.597 20.067 5.84 20.067 L 9.36 20.067 C 9.603 20.067 9.8 20.264 9.8 20.507 Z "></path><path d=" M 5.4 8.773 L 5.4 12.293 C 5.4 12.536 5.203 12.733 4.96 12.733 L 1.44 12.733 C 1.197 12.733 1 12.536 1 12.293 L 1 8.773 C 1 8.53 1.197 8.333 1.44 8.333 L 4.96 8.333 C 5.203 8.333 5.4 8.53 5.4 8.773 Z "></path><path d=" M 10.093 3.933 L 8.04 3.933 C 7.797 3.933 7.6 3.736 7.6 3.493 L 7.6 1.44 C 7.6 1.197 7.797 1 8.04 1 L 10.093 1 C 10.336 1 10.533 1.197 10.533 1.44 L 10.533 3.493 C 10.533 3.736 10.336 3.933 10.093 3.933 Z "></path><path d=" M 20.067 5.84 L 20.067 7.893 C 20.067 8.136 20.264 8.333 20.507 8.333 L 22.56 8.333 C 22.803 8.333 23 8.136 23 7.893 L 23 5.84 C 23 5.597 22.803 5.4 22.56 5.4 L 20.507 5.4 C 20.264 5.4 20.067 5.597 20.067 5.84 Z "></path></g></svg></p></a><div class="jss7"></div><a tabindex="0" class="jss55 jss49 jss50 jss8" role="button" href="https://github.com/adaltas/node-nikita/issues" target="_blank" rel="noopener" aria-labelledby="appbar-bug" title="Report an issue"><span class="jss54"><svg class="jss58" focusable="false" viewBox="0 0 24 24" aria-hidden="true" role="presentation"><path fill="none" d="M0 0h24v24H0V0z"></path><g><path d="M20 8h-2.81c-.45-.78-1.07-1.45-1.82-1.96L17 4.41 15.59 3l-2.17 2.17C12.96 5.06 12.49 5 12 5s-.96.06-1.41.17L8.41 3 7 4.41l1.62 1.63C7.88 6.55 7.26 7.22 6.81 8H4v2h2.09c-.05.33-.09.66-.09 1v1H4v2h2v1c0 .34.04.67.09 1H4v2h2.81c1.04 1.79 2.97 3 5.19 3s4.15-1.21 5.19-3H20v-2h-2.09c.05-.33.09-.66.09-1v-1h2v-2h-2v-1c0-.34-.04-.67-.09-1H20V8zm-4 4v3c0 .22-.03.47-.07.7l-.1.65-.37.65c-.72 1.24-2.04 2-3.46 2s-2.74-.77-3.46-2l-.37-.64-.1-.65C8.03 15.48 8 15.23 8 15v-4c0-.23.03-.48.07-.7l.1-.65.37-.65c.3-.52.72-.97 1.21-1.31l.57-.39.74-.18c.31-.08.63-.12.94-.12.32 0 .63.04.95.12l.68.16.61.42c.5.34.91.78 1.21 1.31l.38.65.1.65c.04.22.07.47.07.69v1z"></path><path d="M10 14h4v2h-4zM10 10h4v2h-4z"></path></g></svg></span><span class="jss67"></span></a><a tabindex="0" class="jss55 jss49 jss50 jss8" role="button" href="https://github.com/adaltas/node-nikita" target="_blank" rel="noopener" aria-labelledby="appbar-github" title="Nikita GitHub Repository"><span class="jss54"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 496 512" height="1em" width="1em"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg></span><span class="jss67"></span></a></div></header><div class="jss2"><main class="jss107"><a tabindex="0" class="jss55 jss49 jss50 jss108" role="button" href="https://github.com/adaltas/node-nikita-docs/edit/master/src/md/about/tutorial.md" target="_blank" rel="noopener" aria-labelledby="content-edit" title="Edit on GitHub"><span class="jss54"><svg class="jss58" focusable="false" viewBox="0 0 24 24" aria-hidden="true" role="presentation"><path fill="none" d="M0 0h24v24H0V0z"></path><g><path d="M14.06 9.02l.92.92L5.92 19H5v-.92l9.06-9.06M17.66 3c-.25 0-.51.1-.7.29l-1.83 1.83 3.75 3.75 1.83-1.83c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.2-.2-.45-.29-.71-.29zm-3.6 3.19L3 17.25V21h3.75L17.81 9.94l-3.75-3.75z"></path></g></svg></span><span class="jss67"></span></a><button tabindex="0" class="jss55 jss49 jss50 jss108" type="button" aria-labelledby="content-toc" title="Toggle table of content"><span class="jss54"><svg class="jss58" focusable="false" viewBox="0 0 24 24" aria-hidden="true" role="presentation"><g fill="none"><path d="M0 0h24v24H0V0z"></path><path d="M0 0h24v24H0V0z" opacity=".87"></path></g><path d="M3 13h2v-2H3v2zm0 4h2v-2H3v2zm0-8h2V7H3v2zm4 4h14v-2H7v2zm0 4h14v-2H7v2zM7 7v2h14V7H7z"></path><path d="M3 13h2v-2H3v2zm0 4h2v-2H3v2zm0-8h2V7H3v2zm4 4h14v-2H7v2zm0 4h14v-2H7v2zM7 7v2h14V7H7z"></path></svg></span><span class="jss67"></span></button><div><h1 id="tutorial"><a href="#tutorial" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Tutorial</h1>
<div class="toc">
<h2><a href="#toc" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Table of Contents</h2>
<ul>
<li><a href="#introduction">Introduction</a></li>
<li>
<p><a href="#what-is-nikita-">What is Nikita ?</a></p>
<ul>
<li><a href="#technologies">Technologies</a></li>
<li><a href="#use-cases">Use cases</a></li>
<li><a href="#what-is-inside-nikita">What is inside Nikita</a></li>
</ul>
</li>
<li>
<p><a href="#installation-instructions">Installation instructions</a></p>
<ul>
<li><a href="#dependencies">Dependencies</a></li>
<li><a href="#initialization">Initialization</a></li>
</ul>
</li>
<li>
<p><a href="#core-concepts">Core concepts</a></p>
<ul>
<li><a href="#about-coffeescript">About CoffeeScript</a></li>
<li><a href="#actions-handler">Actions handler</a></li>
<li><a href="#calling-actions">Calling actions</a></li>
<li><a href="#actions-callback">Actions callback</a></li>
<li><a href="#idempotence-and-status">Idempotence and status</a></li>
<li><a href="#external-actions">External actions</a></li>
<li><a href="#passing-options">Passing options</a></li>
<li><a href="#registering-actions">Registering actions</a></li>
</ul>
</li>
<li>
<p><a href="#real-world-example">Real world example</a></p>
<ul>
<li><a href="#source-compilation">Source compilation</a></li>
<li><a href="#redis-configuration-file">Redis configuration file</a></li>
<li><a href="#cli-reporting-and-logs">CLI reporting and logs</a></li>
<li><a href="#get-the-server-up-and-running">Get the server up and running</a></li>
<li><a href="#checking-the-service-health">Checking the service health</a></li>
<li><a href="#ssh-activation">SSH activation</a></li>
<li><a href="#composition">Composition</a></li>
</ul>
</li>
</ul>
</div>
<h2 id="introduction"><a href="#introduction" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Introduction</h2>
<p>This tutorial covers the basics to get started and to use Nikita. It is organized in 4 sections:</p>
<ul>
<li>What is nikita ?</li>
<li>Installation instructions</li>
<li>Core concepts</li>
<li>Real life example</li>
</ul>
<p>Feel free to skip the second section if you are familiar with Node.js and its ecosystem.</p>
<p>For detailed information, navigate the documentation or submit an issue if you don't find the answers to your questions. Also, if you are looking for examples, the source code is well documented and its test coverage quite complete. We highly encourage you to navigate the tests. Tests are self contained and very easy to understand. They also provide you the guaranty of reading a working code.</p>
<h2 id="what-is-nikita-"><a href="#what-is-nikita-" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>What is Nikita ?</h2>
<p>Nikita is build as a library, which provides simple functions on a host (server, desktop, machine, vm...) either locally or remotely over ssh.</p>
<h3 id="technologies"><a href="#technologies" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Technologies</h3>
<p>Nikita is written in JavaScript and executed by NodeJs. It is delivered as a Node.js package and is available on npm.</p>
<h3 id="use-cases"><a href="#use-cases" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Use cases</h3>
<p>It can serve  multiple purposes. For example, it can be used in a website with a Node.js backend, where you want to execute actions (writing files, copy, move, executing custom scripts..) or you can use it to automate and orchestrate  components' deployments (installations, functional tests, lifecycle management...).</p>
<p>Take a view at <a href="https://github.com/ryba-io/ryba">ryba</a> which contains playbooks to setup and manage bigdata system.</p>
<h3 id="what-is-inside-nikita"><a href="#what-is-inside-nikita" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>What is inside Nikita</h3>
<p>Nikita comes with a set of default functions.
It is bundled with many handy functions covering a large range of usage:</p>
<ul>
<li>write files</li>
<li>execute shell commands</li>
<li>package managements</li>
<li>run docker containers</li>
</ul>
<p>You are encouraged to extend Nikita with your own actions. To write an action is just about writing a plain vanilla javascript function.</p>
<h2 id="installation-instructions"><a href="#installation-instructions" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Installation instructions</h2>
<h3 id="dependencies"><a href="#dependencies" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Dependencies</h3>
<p>To run your code, you must have Node.js and NPM (or YARN) installed. The procedure depends on your operating system. They are multiple alternatives to install Node.js:</p>
<ul>
<li><a href="https://Node.js.org/en/download/">Download</a><br>
The <a href="https://Node.js.org/en/download/">official download page</a> provides you with the choices of downloading an installer, the binary files and the source code.</li>
<li><a href="https://Node.js.org/en/download/package-manager/">Package manager</a><br>
The <a href="https://Node.js.org/en/download/package-manager/">package manager</a> is probably the fastest and easiest way to get Node.js installed and ready while being upgraded in the future. The choice of package managers will depends on your system.</li>
<li>Node.js version manager
<a href="https://github.com/creationix/nvm">NVM</a> and <a href="https://github.com/tj/n">N</a> will manage multiple versions of Node.js in parallel. For advance users, this is our recommended procedure as we personally use <a href="https://github.com/tj/n">N</a>.</li>
</ul>
<p>Once installed, you should have the <code class="language-text">node</code> and <code class="language-text">npm</code> commands available from your terminal.</p>
<h3 id="initialization"><a href="#initialization" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Initialization</h3>
<p>A Nikita project is a Node.js package. Everything is a file and it doesn't require you to rely on any external software such as a database. For this reason we will use <a href="https://en.wikipedia.org/wiki/Version_control">version control systems (VCS)</a> to track our development.
Several tools are available such as <a href="https://git-scm.com/">GIT</a> and <a href="https://www.mercurial-scm.org/">Mercurial</a>. In this tutorial, we will be using <a href="https://git-scm.com/">GIT</a> and publish the source code to the <a href="https://github.com/adaltas/node-nikita-tutorial">node-nikita-tutorial repository on GitHub</a>.</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash"><span class="token comment"># Create a new folder</span>
<span class="token function">mkdir</span> tutorial
<span class="token function">cd</span> tutorial
<span class="token comment"># Initialize the git repository</span>
<span class="token function">git</span> init
<span class="token function">git</span> remote add origin https://github.com/adaltas/node-nikita-tutorial.git
<span class="token comment"># Ignore files</span>
<span class="token function">cat</span> <span class="token operator">></span> .gitignore <span class="token operator">&lt;&lt;</span><span class="token string">MD
.*
/node_modules
!.gitignore
MD</span>
<span class="token comment"># Generate the readme file</span>
<span class="token function">cat</span> <span class="token operator">></span> README.md <span class="token operator">&lt;&lt;</span><span class="token string">MD
# Nikita tutorial

You will learn how to create a new project as well as the fundamentals on using 
Nikita to automate the deployment of systems.

Please refer to the [official project documentation](http://nikita.adaltas.com/about/tutorial/)
for additional information.
MD</span>
<span class="token comment"># Commit to git the project description</span>
<span class="token function">git</span> add .gitignore
<span class="token function">git</span> add README.md
<span class="token function">git</span> commit -m <span class="token string">"Project description"</span></code></pre></div>
<p>A Nikita project is a Node.js project. Thus, we will use the <code class="language-text">npm init</code> command to create a new project. This is a common way to bootstrap a project with the default package definition file. The project unique required dependency is "nikita". There are no other external dependency to declare unless you need to.</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash"><span class="token comment"># Initialize a new project</span>
<span class="token function">npm</span> init
<span class="token comment"># Declare the Nikita dependency</span>
<span class="token function">npm</span> add nikita
<span class="token function">curl</span> https://raw.githubusercontent.com/adaltas/node-nikita/master/LICENSE -o LICENSE
<span class="token comment"># Commit to git the Node.js package declaration file</span>
<span class="token function">git</span> add package.json
<span class="token function">git</span> add package-lock.json
<span class="token function">git</span> add README.md
<span class="token function">git</span> add LICENSE
<span class="token function">git</span> commit -a -m <span class="token string">"Package declaration file"</span></code></pre></div>
<p>The <code class="language-text">npm init</code> command will ask you a few questions such as the project name and its version. You may run with default answers using the <code class="language-text">-y</code> option or get inspiration from this output:</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">package name: (tutorial) nikita-tutorial
version: (1.0.0) 0.0.0
description: Learn how to use Nikita
entry point: (index.js) app.js
test command: mocha test/*.js
git repository: https://github.com/adaltas/node-nikita-tutorial.git
keywords: nikita tutorial
author: David Worms
license: (ISC) BSD-3-Clause</code></pre></div>
<p>A <a href="https://gist.github.com/robertkowalski/7620849">list of possible licenses</a> is available on Github.</p>
<h2 id="core-concepts"><a href="#core-concepts" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Core concepts</h2>
<p>Before installing something useful, let's learn a few basics. Nikita is executed by the Node.js engine. It implies some experience in JavaScript. You don't need to be a JS Ninja but some basic knowledges are required.</p>
<h3 id="about-coffeescript"><a href="#about-coffeescript" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>About CoffeeScript</h3>
<p>This tutorial is written in JavaScript to get you started quickly. If you navigate the Nikita source code, you'll see it is written in CoffeeScript, a language which transpiles into JavaScript before being executed by the Node.js engine. Run <code class="language-text">npm install -g coffeescript</code> to install CoffeeScript globally. Unless you used a Node.js version manager, you will probably encounter a permission error. Read the NPM chapter about <a href="https://docs.npmjs.com/getting-started/fixing-npm-permissions">permissions</a> to select a solution or install it locally without the <code class="language-text">-g</code> option and use the command <code class="language-text">./node_modules/.bin/coffee</code> instead of <code class="language-text">coffee</code>.</p>
<p>CoffeeScript has a very clean syntax and is perfectly suited with the declarative aspect of the Nikita API. In the end, the source code looks like one written in YAML while preserving the advantages of a procedural language like JavaScript. A second advantage we found with CoffeeScript is its <a href="http://coffeescript.org/#literate">literate functionality</a> which let you write Markdown files with CoffeeScript code inside. Your source code looks a bit like a Notebook, it is a markdown document with documentation and code organized in blocks.</p>
<p>At the end of the tutorial, we will show you how a code would look if written in CoffeeScript. </p>
<h3 id="actions-handler"><a href="#actions-handler" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Actions handler</h3>
<p>An action is the basic building block in Nikita. It is basically a function, called a handler, with some associated metadata, called options. It is materialized as a JavaScript object, for example:</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token punctuation">{</span>
  retry<span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
  handler<span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">{</span>options<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span>options<span class="token punctuation">.</span>retry<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
<p>As you can see, options are made available as the first argument of the handler. This handler is synchronous. Declaring a second argument will mark the function as asynchronous. This second argument is a callback function to be called once the action is done.</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token punctuation">{</span>
  retry<span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
  handler<span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">{</span>options<span class="token punctuation">}</span><span class="token punctuation">,</span> callback<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token function">setImmediate</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span>options<span class="token punctuation">.</span>retry<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
<h3 id="calling-actions"><a href="#calling-actions" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Calling actions</h3>
<p>To execute an action, you must create a Nikita session and execute the <code class="language-text">call</code> function:</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js">nikita <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'nikita'</span><span class="token punctuation">)</span>
nikita<span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  retry<span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
  handler<span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">{</span>options<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span>options<span class="token punctuation">.</span>retry<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre></div>
<p>The function <code class="language-text">nikita.call</code> is very flexible in how arguments are passed. It receives zero to multiple objects which will be merged together. Also, a function is interpreted as the action handler, being converted to an object with the <code class="language-text">handler</code> property. It means the previous example could be rewritten as:</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js">nikita <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'nikita'</span><span class="token punctuation">)</span>
nikita<span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  retry<span class="token punctuation">:</span> <span class="token number">2</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">{</span>options<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span>options<span class="token punctuation">.</span>retry<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">)</span></code></pre></div>
<h3 id="actions-callback"><a href="#actions-callback" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Actions callback</h3>
<p>A second function is interpreted as a method to get notified when your handler has completed. It will be converted  to an object with the <code class="language-text">callback</code> property. We call it the action callback.</p>
<p>The action callback is called with two arguments, an error if any and an object containing information from the handler.</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js">nikita <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'nikita'</span><span class="token punctuation">)</span>
nikita<span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>
  <span class="token comment">// Handler</span>
  <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">{</span>options<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span>options<span class="token punctuation">.</span>retry<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">// Callback</span>
  <span class="token keyword">function</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> <span class="token punctuation">{</span>status<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span>err <span class="token operator">?</span> err<span class="token punctuation">.</span>message <span class="token punctuation">:</span> status<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">)</span></code></pre></div>
<h3 id="idempotence-and-status"><a href="#idempotence-and-status" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Idempotence and status</h3>
<p>In the context of software deployment, idempotence means that an action with the same parameters can be executed multiple times without changing the final state of the system. It is a fundamental concept and every action in Nikita follows this principle.</p>
<p>The status is used and interpreted with different meanings but in most cases it indicates that a change occurred. Read the action documentation in case of any doubt. For example, an action similar to the POSIX <code class="language-text">touch</code> command could be designed to return "true" on its first run and "false" later on because the file already exists:</p>
<blockquote>
<p>Important: you will encounter an error the second time you execute this code because the target file will be present and status will be set to "true" instead of "false". Simply remove the file with <code class="language-text">rm /tmp/a_file</code> to overcome this issue.</p>
</blockquote>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token comment">// Dependencies</span>
assert <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'assert'</span><span class="token punctuation">)</span>
fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span>
nikita <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'nikita'</span><span class="token punctuation">)</span>
<span class="token comment">// Touch implementation</span>
<span class="token function-variable function">touch</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">{</span>options<span class="token punctuation">}</span><span class="token punctuation">,</span> callback<span class="token punctuation">)</span><span class="token punctuation">{</span>
  fs<span class="token punctuation">.</span><span class="token function">stat</span><span class="token punctuation">(</span><span class="token string">'/tmp/a_file'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> stat<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>err <span class="token operator">&amp;&amp;</span> err<span class="token punctuation">.</span>code <span class="token operator">!==</span> <span class="token string">'ENOENT'</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token function">callback</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>err<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token function">callback</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
    fs<span class="token punctuation">.</span><span class="token function">writeFile</span><span class="token punctuation">(</span><span class="token string">'/tmp/a_file'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token function">callback</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">// New Nikita session</span>
nikita
<span class="token comment">// First time calling touch</span>
<span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>touch<span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> <span class="token punctuation">{</span>status<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  assert<span class="token punctuation">.</span><span class="token function">equal</span><span class="token punctuation">(</span>status<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">// Second time calling touch</span>
<span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>touch<span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> <span class="token punctuation">{</span>status<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  assert<span class="token punctuation">.</span><span class="token function">equal</span><span class="token punctuation">(</span>status<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre></div>
<p>Note, there is an existing <code class="language-text">nikita.file.touch</code> action which does just that with additional functionalities such as detecting and applying changes of ownerships and permissions.</p>
<h3 id="external-actions"><a href="#external-actions" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>External actions</h3>
<p>In order to reuse our new <code class="language-text">touch</code> action, we could isolate it into a separate file. The new file is called a module in Node.js terminology. Nikita <code class="language-text">call</code> will accept the exported object or function. A string is interpreted as the module path and will be automatically imported. Let's create two files "./lib/touch.js" and "app.js":</p>
<p>File "./lib/touch.js":</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token comment">// Dependencies</span>
fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span>
<span class="token comment">// Touch implementation</span>
module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">{</span>options<span class="token punctuation">}</span><span class="token punctuation">,</span> callback<span class="token punctuation">)</span><span class="token punctuation">{</span>
  fs<span class="token punctuation">.</span><span class="token function">stat</span><span class="token punctuation">(</span><span class="token string">'/tmp/a_file'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> stat<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>err <span class="token operator">&amp;&amp;</span> err<span class="token punctuation">.</span>code <span class="token operator">!==</span> <span class="token string">'ENOENT'</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token function">callback</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>err<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token function">callback</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
    fs<span class="token punctuation">.</span><span class="token function">writeFile</span><span class="token punctuation">(</span><span class="token string">'/tmp/a_file'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token function">callback</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span></code></pre></div>
<p>File "app.js":</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token comment">// Dependencies</span>
assert <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'assert'</span><span class="token punctuation">)</span>
nikita <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'nikita'</span><span class="token punctuation">)</span>
touch <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./lib/touch'</span><span class="token punctuation">)</span>
<span class="token comment">// New Nikita session</span>
nikita
<span class="token comment">// Calling touch module</span>
<span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>touch<span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> <span class="token punctuation">{</span>status<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  assert<span class="token punctuation">.</span><span class="token function">equal</span><span class="token punctuation">(</span>status<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre></div>
<p>Which is identical to:</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token comment">// Dependencies</span>
nikita <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'nikita'</span><span class="token punctuation">)</span>
assert <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'assert'</span><span class="token punctuation">)</span>
<span class="token comment">// New Nikita session</span>
nikita
<span class="token comment">// Calling touch module</span>
<span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token string">'./lib/touch'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> <span class="token punctuation">{</span>status<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  assert<span class="token punctuation">.</span><span class="token function">equal</span><span class="token punctuation">(</span>status<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre></div>
<h3 id="passing-options"><a href="#passing-options" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Passing options</h3>
<p>The <code class="language-text">touch</code> action is now a separate Node.js module. It is a vanilla JavaScript function which may receive options. There are many options which are globally available to every actions such as <code class="language-text">header</code>, <code class="language-text">retry</code>, <code class="language-text">relax</code>. We encourage you to navigate the documentation. Covering all of them is not in the scope of this tutorial. You can also create your own options. Let's pass the path of the target file as an option:</p>
<p>File "./lib/touch.js":</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token comment">// Dependencies</span>
fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span>
<span class="token comment">// Touch implementation</span>
module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">{</span>options<span class="token punctuation">}</span><span class="token punctuation">,</span> callback<span class="token punctuation">)</span><span class="token punctuation">{</span>
  fs<span class="token punctuation">.</span><span class="token function">stat</span><span class="token punctuation">(</span>options<span class="token punctuation">.</span>target<span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> stat<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>err <span class="token operator">&amp;&amp;</span> err<span class="token punctuation">.</span>code <span class="token operator">!==</span> <span class="token string">'ENOENT'</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token function">callback</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>err<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token function">callback</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
    fs<span class="token punctuation">.</span><span class="token function">writeFile</span><span class="token punctuation">(</span>options<span class="token punctuation">.</span>target<span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token function">callback</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span></code></pre></div>
<p>File "app.js": </p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token comment">// Dependencies</span>
assert <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'assert'</span><span class="token punctuation">)</span>
nikita <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'nikita'</span><span class="token punctuation">)</span>
<span class="token comment">// New Nikita session</span>
nikita
<span class="token comment">// Calling touch module</span>
<span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token string">'./lib/touch'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token string">'target'</span><span class="token punctuation">:</span> <span class="token string">'./touchme'</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> <span class="token punctuation">{</span>status<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token function">assert</span><span class="token punctuation">(</span>status<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre></div>
<h3 id="registering-actions"><a href="#registering-actions" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Registering actions</h3>
<p>Instead of using the <code class="language-text">call</code> action, it might be more comfortable to call our <code class="language-text">touch</code> action by its name. To do so, we will register it. Actions can be registered in the current session or globally. In the example below, we will register it globally:</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token comment">// Dependencies</span>
assert <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'assert'</span><span class="token punctuation">)</span>
nikita <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'nikita'</span><span class="token punctuation">)</span>
<span class="token comment">// Register the touch action</span>
nikita<span class="token punctuation">.</span>registry<span class="token punctuation">.</span><span class="token function">register</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'touch'</span><span class="token punctuation">:</span> <span class="token string">'./lib/touch'</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">// New Nikita session</span>
nikita
<span class="token comment">// Calling the touch action</span>
<span class="token punctuation">.</span><span class="token function">touch</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'target'</span><span class="token punctuation">:</span> <span class="token string">'./touchme'</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> <span class="token punctuation">{</span>status<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token function">assert</span><span class="token punctuation">(</span>status<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre></div>
<h2 id="real-world-example"><a href="#real-world-example" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Real world example</h2>
<p>For the sake of this tutorial, we will create a basic Redis installation. The installation steps are:</p>
<ul>
<li>Source compilation<br>
<em>Learn how to execute shell commands and use conditions.</em></li>
<li>Redis configuration file<br>
<em>Learn how to merge or overwrite a configuration by serializing a JavaScript vanilla object.</em></li>
<li>CLI reporting and logs<br>
<em>Learn how to activate pretty reporting and detailed logs written in Markdown.</em></li>
<li>Get the server up and running<br>
<em>Learn how to leverage exit code to alter the action status.</em></li>
<li>Checking the service health<br>
<em>Learn how to use the <code class="language-text">relax</code> and <code class="language-text">shy</code> option.</em></li>
<li>SSH activation<br>
<em>Learn how easy and transparent it is to activate SSH.</em></li>
<li>Composition<br>
<em>Learn how to chain multiple actions sequentially and compose them as children of other actions</em></li>
</ul>
<h3 id="source-compilation"><a href="#source-compilation" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Source compilation</h3>
<p><em>Learn how to execute shell command and use conditions.</em></p>
<p>Following the <a href="https://redis.io/topics/quickstart">Redis quickstart guide</a>, getting Redis up and ready is about downloading the package and executing the <code class="language-text">redis-server</code> command. We will do this with idempotence in mind.</p>
<p>To download Redis, we will use the existing <code class="language-text">nikita.file.download</code> action.</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'nikita'</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span>file<span class="token punctuation">.</span><span class="token function">download</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  source<span class="token punctuation">:</span> <span class="token string">'http://download.redis.io/redis-stable.tar.gz'</span><span class="token punctuation">,</span>
  target<span class="token punctuation">:</span> <span class="token string">'cache/redis-stable.tar.gz'</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> <span class="token punctuation">{</span>status<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">'Redis download'</span><span class="token punctuation">,</span> err <span class="token operator">?</span> <span class="token string">'x'</span> <span class="token punctuation">:</span> status <span class="token operator">?</span> <span class="token string">'✔'</span> <span class="token punctuation">:</span> <span class="token string">'-'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre></div>
<p>The second time <code class="language-text">nikita.file.download</code> is called, it will check if the target exists and bypass the download in such case. You could also adjust this behavior based on the file signature by using one of the "md5", "sha1" and "sha256" options.</p>
<p>To extract and compile Redis, we will write a shell script which will only be executed if a specific generated file does not already exist. Nikita comes with a few native conditions prefixed with "if<em>" and their associated negation prefixed with "unless</em>". There are also some assertions prefixed by "should<em>" and "should</em>not_" which will throw an error unless satisfied.</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'nikita'</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span>system<span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  unless_exists<span class="token punctuation">:</span> <span class="token string">'redis-stable/src/redis-server'</span>
  cmd<span class="token punctuation">:</span> <span class="token template-string"><span class="token string">`
  tar xzf cache/redis-stable.tar.gz
  cd redis-stable
  make
  `</span></span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> <span class="token punctuation">{</span>status<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">'Redis installation'</span><span class="token punctuation">,</span> err <span class="token operator">?</span> <span class="token string">'x'</span> <span class="token punctuation">:</span> status <span class="token operator">?</span> <span class="token string">'✔'</span> <span class="token punctuation">:</span> <span class="token string">'-'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre></div>
<h3 id="redis-configuration-file"><a href="#redis-configuration-file" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Redis configuration file</h3>
<p><em>Learn how to merge or overwrite a configuration by serializing a JavaScript vanilla object.</em></p>
<p>Before starting the server, we will write a configuration file. The Redis format is made of key value pairs separated by spaces. This type of format can be handled with the <code class="language-text">nikita.file.properties</code> action with a custom <code class="language-text">separator</code> option set to one space. The action also comes with some handy options like <code class="language-text">comment</code> to preserve comments and <code class="language-text">merge</code> to preserve the properties already present in the file. </p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'nikita'</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span>file<span class="token punctuation">.</span><span class="token function">properties</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  target<span class="token punctuation">:</span> <span class="token string">'conf/redis.conf'</span><span class="token punctuation">,</span>
  separator<span class="token punctuation">:</span> <span class="token string">' '</span><span class="token punctuation">,</span>
  content<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token string">'bind'</span><span class="token punctuation">:</span> <span class="token string">'127.0.0.1'</span><span class="token punctuation">,</span>
    <span class="token string">'protected-mode'</span><span class="token punctuation">:</span> <span class="token string">'yes'</span><span class="token punctuation">,</span>
    <span class="token string">'port'</span><span class="token punctuation">:</span> <span class="token number">6379</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> <span class="token punctuation">{</span>status<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">'Redis configuration'</span><span class="token punctuation">,</span> err <span class="token operator">?</span> <span class="token string">'x'</span> <span class="token punctuation">:</span> status <span class="token operator">?</span> <span class="token string">'✔'</span> <span class="token punctuation">:</span> <span class="token string">'-'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre></div>
<h3 id="cli-reporting-and-logs"><a href="#cli-reporting-and-logs" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>CLI reporting and logs</h3>
<p><em>Learn how to activate pretty reporting and detailed logs written in Markdown.</em></p>
<p>So far, the action callback was used to catch errors and status and to manually output a message to the user with the <code class="language-text">console.info</code> JavaScript function. This process is automatically managed by the <code class="language-text">nikita.log.cli</code> action. A message is printed to the user terminal whenever the <code class="language-text">header</code> option is present:</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'nikita'</span><span class="token punctuation">)</span>
<span class="token comment">// Activate CLI reporting</span>
<span class="token punctuation">.</span>log<span class="token punctuation">.</span><span class="token function">cli</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// Call any action</span>
<span class="token punctuation">.</span>file<span class="token punctuation">.</span><span class="token function">properties</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token comment">// The CLI message</span>
  header<span class="token punctuation">:</span> <span class="token string">'Redis configuration'</span>
  target<span class="token punctuation">:</span> <span class="token string">'conf/redis.conf'</span><span class="token punctuation">,</span>
  separator<span class="token punctuation">:</span> <span class="token string">' '</span><span class="token punctuation">,</span>
  content<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token string">'bind'</span><span class="token punctuation">:</span> <span class="token string">'127.0.0.1'</span><span class="token punctuation">,</span>
    <span class="token string">'protected-mode'</span><span class="token punctuation">:</span> <span class="token string">'yes'</span><span class="token punctuation">,</span>
    <span class="token string">'port'</span><span class="token punctuation">:</span> <span class="token number">6379</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre></div>
<p>Nikita doesn't have to run as a black box. What if an action failed and the error message is not explicit enough? What if a system command failed and we need to dig and get detailed information? Multiple error reporting action are made available such as the <code class="language-text">nikita.log.md</code> which writes logs in the Markdown format:</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'nikita'</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span>log<span class="token punctuation">.</span><span class="token function">md</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span>file<span class="token punctuation">.</span><span class="token function">properties</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  header<span class="token punctuation">:</span> <span class="token string">'Redis configuration'</span><span class="token punctuation">,</span>
  target<span class="token punctuation">:</span> <span class="token string">'conf/redis.conf'</span><span class="token punctuation">,</span>
  separator<span class="token punctuation">:</span> <span class="token string">' '</span><span class="token punctuation">,</span>
  content<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token string">'bind'</span><span class="token punctuation">:</span> <span class="token string">'127.0.0.1'</span><span class="token punctuation">,</span>
    <span class="token string">'protected-mode'</span><span class="token punctuation">:</span> <span class="token string">'yes'</span><span class="token punctuation">,</span>
    <span class="token string">'port'</span><span class="token punctuation">:</span> <span class="token number">6379</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre></div>
<p>Under the hood, both the <code class="language-text">nikita.log.cli</code> and the <code class="language-text">nikita.log.md</code> actions leverage the native Node.js <a href="https://Node.js.org/api/events.html">event API</a>. You can get more detailed information by visiting the <a href="/usages/logging_debugging/">Logging and Debugging</a> documentation.</p>
<h3 id="get-the-server-up-and-running"><a href="#get-the-server-up-and-running" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Get the server up and running</h3>
<p><em>Learn how to leverage exit code to alter the action status.</em></p>
<p>The Redis server is now configured and ready to be started. The status reflects whether the server was already started or not based on the shell exit code. The value "0" will indicate that the server was started, the value "3" will indicate that it was already running and any other exit code will be treated as an error.</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'nikita'</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span>system<span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  code_skipped<span class="token punctuation">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
  cmd<span class="token punctuation">:</span> <span class="token template-string"><span class="token string">`
  # Exit code 3 if ping is successful
  ./src/redis-cli ping &amp;&amp; exit 3
  # Otherwise start the server
  nohup ./src/redis-server conf/redis.conf &amp;
  `</span></span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> <span class="token punctuation">{</span>status<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">'Redis startup'</span><span class="token punctuation">,</span> err <span class="token operator">?</span> <span class="token string">'x'</span> <span class="token punctuation">:</span> status <span class="token operator">?</span> <span class="token string">'✔'</span> <span class="token punctuation">:</span> <span class="token string">'-'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre></div>
<h3 id="checking-the-service-health"><a href="#checking-the-service-health" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Checking the service health</h3>
<p><em>Learn how to use the <code class="language-text">relax</code> and <code class="language-text">shy</code> option.</em></p>
<p>The Redis "PING" command is expected to return "PONG" if the server is healthy. We will illustrate the usage of the <code class="language-text">relax</code> and <code class="language-text">shy</code> options with this use case. The <code class="language-text">relax</code> option will send the error to the callback without propagating it to the overall session, thus allowing the Nikita session to exit gracefully while printing 'x' in case of an error. Similarly, the <code class="language-text">shy</code> option will allow us to set the status to "true" and print "✔" on success without modifying the global status as obtained from <code class="language-text">nikita.next</code> because it is not considered as a change of state.</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'nikita'</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span>system<span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  relax<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  shy<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  cmd<span class="token punctuation">:</span> <span class="token string">'./src/redis-cli -h 127.0.0.1 -p 6379 ping | grep PONG'</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> <span class="token punctuation">{</span>status<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">'Redis check'</span><span class="token punctuation">,</span> err <span class="token operator">?</span> <span class="token string">'x'</span> <span class="token punctuation">:</span> status <span class="token operator">?</span> <span class="token string">'✔'</span> <span class="token punctuation">:</span> <span class="token string">'-'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> <span class="token punctuation">{</span>status<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">'Finished'</span><span class="token punctuation">,</span> err <span class="token operator">?</span> <span class="token string">'x'</span> <span class="token punctuation">:</span> status <span class="token operator">?</span> <span class="token string">'✔'</span> <span class="token punctuation">:</span> <span class="token string">'-'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre></div>
<h3 id="ssh-activation"><a href="#ssh-activation" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>SSH activation</h3>
<p><em>Learn how easy and transparent it is to activate SSH.</em></p>
<p>Nikita is written from the ground up to be transparent whether it is executed locally or over SSH. In fact, all the tests are provided with an ssh argument and are executed twice. The first time with the connection set to null and the second time with an established SSH connection.</p>
<p>Calling <code class="language-text">nikita.ssh.open</code> and <code class="language-text">nikita.ssh.close</code> will associate the Nikita current session with and without an SSH connection. The <code class="language-text">nikita.ssh.open</code> action must be registered before scheduling any other actions and,
inversely, the <code class="language-text">nikita.ssh.close</code> action must be registered last. Both the <code class="language-text">nikita.log.cli</code> and <code class="language-text">nikital.log.md</code> actions are always executed locally. When SSH is setup, passing the <code class="language-text">ssh</code> option to selected actions activates and deactivates the SSH connection.</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'nikita'</span><span class="token punctuation">)</span>
<span class="token comment">// Open the SSH Connection</span>
<span class="token punctuation">.</span>ssh<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  host<span class="token punctuation">:</span> <span class="token string">'127.0.0.1'</span><span class="token punctuation">,</span>
  port<span class="token punctuation">:</span> <span class="token string">'22'</span><span class="token punctuation">,</span>
  private_key_path<span class="token punctuation">:</span> <span class="token string">'~/.ssh/id_rsa'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">// Call one or multiple actions</span>
<span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">'Business as usual'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">// Close the SSH Connection</span>
<span class="token punctuation">.</span>ssh<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre></div>
<p>The above example assumes that you can self connect with SSH locally. If this is not the case, SSH must be installed and listening on port 22 and you must follows the instruction targeting your operating system to get it up and running. A pair of SSH private and public keys, respectively installed at "~/.ssh/id<em>rsa" and "~/.ssh/id</em>rsa.pub", must be present and your public key must be registered inside "~/.ssh/authorized_keys". If this isn't already the case, you can run the following commands:</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash"><span class="token comment"># Detect if private key is already present</span>
<span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token operator">!</span> -f ~/.ssh/id_rsa <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
  <span class="token comment"># Generate private and public keys</span>
  ssh-keygen -t rsa -f ~/.ssh/id_rsa -N <span class="token string">''</span>
<span class="token keyword">fi</span>
<span class="token comment"># Allow self access</span>
<span class="token function">cat</span> ~/.ssh/id_rsa.pub <span class="token operator">>></span> ~/.ssh/authorized_keys
<span class="token comment"># Ensure permissions are valid</span>
<span class="token function">chmod</span> 0700 ~/.ssh
<span class="token function">chmod</span> 0600 ~/.ssh/authorized_keys
<span class="token comment"># Test access</span>
<span class="token function">ssh</span> <span class="token variable"><span class="token variable">`</span><span class="token function">whoami</span><span class="token variable">`</span></span>@127.0.0.1 <span class="token string">"echo 'I am inside'; exit"</span></code></pre></div>
<h3 id="composition"><a href="#composition" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Composition</h3>
<p><em>Learn how to chain multiple actions sequentially and compose them as children of other actions</em></p>
<p>It is time to finalize our script and run all these actions sequentially. Every time you call an action, you scheduled it into the internal Nikita session for later execution. Because calling an action return the Nikita session unless a <code class="language-text">get</code> option is encountered, it is possible to chain multiple calls.</p>
<p>It is also possible to group multiple actions into one action, creating a hierarchical representation and enabling composition. In our example, we will regroup all Redis actions related to installation into a single action.</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'nikita'</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span>log<span class="token punctuation">.</span><span class="token function">cli</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span>log<span class="token punctuation">.</span><span class="token function">md</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span>ssh<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  host<span class="token punctuation">:</span> <span class="token string">'127.0.0.1'</span><span class="token punctuation">,</span>
  port<span class="token punctuation">:</span> <span class="token string">'22'</span><span class="token punctuation">,</span>
  private_key_path<span class="token punctuation">:</span> <span class="token string">'~/.ssh/id_rsa'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  header<span class="token punctuation">:</span> <span class="token string">'Redis Installation'</span><span class="token punctuation">,</span>
  handler<span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">this</span>
    <span class="token punctuation">.</span>file<span class="token punctuation">.</span><span class="token function">download</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      header<span class="token punctuation">:</span> <span class="token string">'Download'</span><span class="token punctuation">,</span>
      source<span class="token punctuation">:</span> <span class="token string">'http://download.redis.io/redis-stable.tar.gz'</span><span class="token punctuation">,</span>
      target<span class="token punctuation">:</span> <span class="token string">'cache/redis-stable.tar.gz'</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span>system<span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      header<span class="token punctuation">:</span> <span class="token string">'Compilation'</span><span class="token punctuation">,</span>
      unless_exists<span class="token punctuation">:</span> <span class="token string">'redis-stable/src/redis-server'</span><span class="token punctuation">,</span>
      cmd<span class="token punctuation">:</span> <span class="token template-string"><span class="token string">`
      tar xzf cache/redis-stable.tar.gz
      cd redis-stable
      make
      `</span></span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span>file<span class="token punctuation">.</span><span class="token function">properties</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      header<span class="token punctuation">:</span> <span class="token string">'Configuration'</span><span class="token punctuation">,</span>
      target<span class="token punctuation">:</span> <span class="token string">'conf/redis.conf'</span><span class="token punctuation">,</span>
      separator<span class="token punctuation">:</span> <span class="token string">' '</span><span class="token punctuation">,</span>
      content<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        <span class="token string">'bind'</span><span class="token punctuation">:</span> <span class="token string">'127.0.0.1'</span><span class="token punctuation">,</span>
        <span class="token string">'protected-mode'</span><span class="token punctuation">:</span> <span class="token string">'yes'</span><span class="token punctuation">,</span>
        <span class="token string">'port'</span><span class="token punctuation">:</span> <span class="token number">6379</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span>system<span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      header<span class="token punctuation">:</span> <span class="token string">'Startup'</span><span class="token punctuation">,</span>
      code_skipped<span class="token punctuation">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
      cmd<span class="token punctuation">:</span> <span class="token template-string"><span class="token string">`
      ./src/redis-cli ping &amp;&amp; exit 3
      nohup ./src/redis-server conf/redis.conf &amp;
      `</span></span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span>system<span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  header<span class="token punctuation">:</span> <span class="token string">'Redis Check'</span><span class="token punctuation">,</span>
  relax<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  shy<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  cmd<span class="token punctuation">:</span> <span class="token string">'./src/redis-cli -h 127.0.0.1 -p 6379 ping'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span>ssh<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre></div>
<p>Finally, we will split this code into one file to pilot our application and two files to encapsulate our install and check actions. We will also enhance our actions with more flexible options:</p>
<p>File "app.js"</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token comment">// Configuration</span>
options <span class="token operator">=</span> <span class="token punctuation">{</span>
  ssh<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    host<span class="token punctuation">:</span> <span class="token string">'127.0.0.1'</span><span class="token punctuation">,</span>
    port<span class="token punctuation">:</span> <span class="token string">'22'</span><span class="token punctuation">,</span>
    username<span class="token punctuation">:</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">USER</span><span class="token punctuation">,</span>
    private_key_path<span class="token punctuation">:</span> <span class="token string">'~/.ssh/id_rsa'</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  redis<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    cwd<span class="token punctuation">:</span> <span class="token string">'/tmp/nikita-tutorial'</span><span class="token punctuation">,</span>
    config<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">// Run the application</span>
<span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'nikita'</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span>log<span class="token punctuation">.</span><span class="token function">cli</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span>log<span class="token punctuation">.</span><span class="token function">md</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span>ssh<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token punctuation">{</span>header<span class="token punctuation">:</span> <span class="token string">'SSH Open'</span><span class="token punctuation">}</span><span class="token punctuation">,</span> options<span class="token punctuation">.</span>ssh<span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token punctuation">{</span>header<span class="token punctuation">:</span> <span class="token string">'Redis Install'</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">'./lib/install'</span><span class="token punctuation">,</span> options<span class="token punctuation">.</span>redis<span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token punctuation">{</span>header<span class="token punctuation">:</span> <span class="token string">'Redis Check'</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">'./lib/check'</span><span class="token punctuation">,</span> options<span class="token punctuation">.</span>redis<span class="token punctuation">)</span>
<span class="token punctuation">.</span>ssh<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">{</span>header<span class="token punctuation">:</span> <span class="token string">'SSH Close'</span><span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre></div>
<p>File "./lib/install.js"</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js">module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">{</span>options<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token comment">// Default options</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>options<span class="token punctuation">.</span>url<span class="token punctuation">)</span><span class="token punctuation">{</span> options<span class="token punctuation">.</span>url <span class="token operator">=</span> <span class="token string">'http://download.redis.io/redis-stable.tar.gz'</span> <span class="token punctuation">}</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>options<span class="token punctuation">.</span>config<span class="token punctuation">)</span><span class="token punctuation">{</span> options<span class="token punctuation">.</span>config <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token punctuation">}</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>options<span class="token punctuation">.</span>config<span class="token punctuation">[</span><span class="token string">'bind'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">{</span> options<span class="token punctuation">.</span>config<span class="token punctuation">[</span><span class="token string">'bind'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'127.0.0.1'</span> <span class="token punctuation">}</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>options<span class="token punctuation">.</span>config<span class="token punctuation">[</span><span class="token string">'protected-mode'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">{</span> options<span class="token punctuation">.</span>config<span class="token punctuation">[</span><span class="token string">'protected-mode'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'yes'</span> <span class="token punctuation">}</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>options<span class="token punctuation">.</span>config<span class="token punctuation">[</span><span class="token string">'port'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">{</span> options<span class="token punctuation">.</span>config<span class="token punctuation">[</span><span class="token string">'port'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">6379</span> <span class="token punctuation">}</span>
  <span class="token comment">// Do the job</span>
  <span class="token keyword">this</span>
  <span class="token punctuation">.</span>file<span class="token punctuation">.</span><span class="token function">download</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    header<span class="token punctuation">:</span> <span class="token string">'Download'</span><span class="token punctuation">,</span>
    source<span class="token punctuation">:</span> options<span class="token punctuation">.</span>url<span class="token punctuation">,</span>
    target<span class="token punctuation">:</span> <span class="token string">'cache/redis-stable.tar.gz'</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span>system<span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    header<span class="token punctuation">:</span> <span class="token string">'Compilation'</span><span class="token punctuation">,</span>
    unless_exists<span class="token punctuation">:</span> <span class="token string">'redis-stable/src/redis-server'</span><span class="token punctuation">,</span>
    cmd<span class="token punctuation">:</span> <span class="token template-string"><span class="token string">`
    tar xzf cache/redis-stable.tar.gz
    cd redis-stable
    make
    `</span></span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span>file<span class="token punctuation">.</span><span class="token function">properties</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    header<span class="token punctuation">:</span> <span class="token string">'Configuration'</span><span class="token punctuation">,</span>
    target<span class="token punctuation">:</span> <span class="token string">'conf/redis.conf'</span><span class="token punctuation">,</span>
    separator<span class="token punctuation">:</span> <span class="token string">' '</span><span class="token punctuation">,</span>
    content<span class="token punctuation">:</span> options<span class="token punctuation">.</span>config
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span>system<span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    header<span class="token punctuation">:</span> <span class="token string">'Startup'</span><span class="token punctuation">,</span>
    code_skipped<span class="token punctuation">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
    cmd<span class="token punctuation">:</span> <span class="token template-string"><span class="token string">`
    ./src/redis-cli ping &amp;&amp; exit 3
    nohup ./redis-stable/src/redis-server conf/redis.conf &amp;
    `</span></span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span></code></pre></div>
<p>File "./lib/check.js"</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js">module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token comment">// Get options from config if present</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>options<span class="token punctuation">.</span>config<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>options<span class="token punctuation">.</span>config<span class="token punctuation">.</span>host<span class="token punctuation">)</span><span class="token punctuation">{</span> options<span class="token punctuation">.</span>host <span class="token operator">=</span> options<span class="token punctuation">.</span>config<span class="token punctuation">.</span>host <span class="token punctuation">}</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>options<span class="token punctuation">.</span>config<span class="token punctuation">.</span>port<span class="token punctuation">)</span><span class="token punctuation">{</span> options<span class="token punctuation">.</span>port <span class="token operator">=</span> options<span class="token punctuation">.</span>config<span class="token punctuation">.</span>port <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// Default options</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>options<span class="token punctuation">.</span>host<span class="token punctuation">)</span><span class="token punctuation">{</span> options<span class="token punctuation">.</span>host <span class="token operator">=</span> <span class="token string">'127.0.0.1'</span> <span class="token punctuation">}</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>options<span class="token punctuation">.</span>port<span class="token punctuation">)</span><span class="token punctuation">{</span> options<span class="token punctuation">.</span>port <span class="token operator">=</span> <span class="token number">6379</span> <span class="token punctuation">}</span>
  <span class="token comment">// Do the job</span>
  <span class="token keyword">this</span>
  <span class="token punctuation">.</span>system<span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    header<span class="token punctuation">:</span> <span class="token string">'Redis Check'</span><span class="token punctuation">,</span>
    relax<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    shy<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    cmd<span class="token punctuation">:</span> <span class="token template-string"><span class="token string">`./redis-stable/src/redis-cli -h </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>options<span class="token punctuation">.</span>host<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> -p  </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>options<span class="token punctuation">.</span>port<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> ping`</span></span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span></code></pre></div></div></main><footer class="jss109"><div class="jss110"><div class="jss115"><div class="jss116 jss149 jss160"><div class="jss112"><h3 class="jss74 jss81 jss111">Navigate</h3><ul class="jss113"><li><a href="/about/">Getting started</a></li><li><a href="/usages/">Usages</a></li><li><a href="/options/">Options</a></li></ul></div></div><div class="jss116 jss149 jss160"><div class="jss112"><h3 class="jss74 jss81 jss111">Contribute</h3><ul class="jss113"><li><a href="https://github.com/adaltas/node-nikita" target="_blank" rel="noopener">GitHub</a></li><li><a href="https://github.com/adaltas/node-nikita/issues" target="_blank" rel="noopener">Issue Tracker</a></li><li><a href="/about/license">License</a></li></ul></div></div><div class="jss116 jss155 jss163"><div class="jss112"><h3 class="jss74 jss81 jss111">About</h3><p class="jss74 jss83 jss114">Nikita is an open source product hosted on <a href="https://www.github.com" target="_blank" rel="noopener">GitHub</a> and developed by <a href="http://www.adaltas.com" target="_blank" rel="noopener">Adaltas</a>.</p></div></div></div></div></footer></div></div><div class="css-d35p82"><div class="jss212"><div><div class="jss213"><a href="/"><h2 class="jss74 jss80 jss94">Documentation</h2></a><span class="jss74 jss84">version 0.8</span></div><hr class="jss215"/></div><div class="jss219"><nav class="jss223 jss224" role="menu"><li class="jss230"><a tabindex="-1" class="jss55 jss229 jss232 jss236 jss237 jss238 jss227" role="menuitem" href="/about/"><div class="jss240"><span class="jss74 jss81 jss243">About</span></div><span class="jss67"></span></a><div class="jss246"><button tabindex="0" class="jss55 jss49" type="button"><span class="jss54"><svg class="jss58" focusable="false" viewBox="0 0 24 24" aria-hidden="true" role="presentation"><path d="M12 8l-6 6 1.41 1.41L12 10.83l4.59 4.58L18 14z"></path><path fill="none" d="M0 0h24v24H0z"></path></svg></span><span class="jss67"></span></button></div></li><div class="jss247 jss248" style="min-height:0px" tabindex="-1"><div class="jss249"><div class="jss250"><ul class="jss223" role="menu"><a tabindex="-1" class="jss55 jss229 jss232 jss236 jss237 jss227 jss221 jss220" role="menuitem" href="/about/introduction/">Introduction<span class="jss67"></span></a><a aria-current="page" tabindex="-1" class="jss55 jss229 jss232 jss236 jss237 jss227 jss221 jss220 jss222" role="menuitem" href="/about/tutorial/">Tutorial<span class="jss67"></span></a><a tabindex="-1" class="jss55 jss229 jss232 jss236 jss237 jss227 jss221 jss220" role="menuitem" href="/about/developers/">Developer<span class="jss67"></span></a><a tabindex="-1" class="jss55 jss229 jss232 jss236 jss237 jss227 jss221 jss220" role="menuitem" href="/about/contribute/">Contribute<span class="jss67"></span></a><a tabindex="-1" class="jss55 jss229 jss232 jss236 jss237 jss227 jss221 jss220" role="menuitem" href="/about/changelog/">Changelog<span class="jss67"></span></a><a tabindex="-1" class="jss55 jss229 jss232 jss236 jss237 jss227 jss221 jss220" role="menuitem" href="/about/license/">License (MIT)<span class="jss67"></span></a></ul></div></div></div></nav></div><div class="jss219"><nav class="jss223 jss224" role="menu"><li class="jss230"><a tabindex="-1" class="jss55 jss229 jss232 jss236 jss237 jss238 jss227" role="menuitem" href="/usages/"><div class="jss240"><span class="jss74 jss81 jss243">Usages</span></div><span class="jss67"></span></a><div class="jss246"><button tabindex="0" class="jss55 jss49" type="button"><span class="jss54"><svg class="jss58" focusable="false" viewBox="0 0 24 24" aria-hidden="true" role="presentation"><path d="M12 8l-6 6 1.41 1.41L12 10.83l4.59 4.58L18 14z"></path><path fill="none" d="M0 0h24v24H0z"></path></svg></span><span class="jss67"></span></button></div></li><div class="jss247 jss248" style="min-height:0px" tabindex="-1"><div class="jss249"><div class="jss250"><ul class="jss223" role="menu"><a tabindex="-1" class="jss55 jss229 jss232 jss236 jss237 jss227 jss221 jss220" role="menuitem" href="/usages/local_remote/">Local and Remote (SSH)<span class="jss67"></span></a><a tabindex="-1" class="jss55 jss229 jss232 jss236 jss237 jss227 jss221 jss220" role="menuitem" href="/usages/actions/">Actions<span class="jss67"></span></a><a tabindex="-1" class="jss55 jss229 jss232 jss236 jss237 jss227 jss221 jss220" role="menuitem" href="/usages/sync_async/">Sync and async<span class="jss67"></span></a><a tabindex="-1" class="jss55 jss229 jss232 jss236 jss237 jss227 jss221 jss220" role="menuitem" href="/usages/call/">Call<span class="jss67"></span></a><a tabindex="-1" class="jss55 jss229 jss232 jss236 jss237 jss227 jss221 jss220" role="menuitem" href="/usages/registry/">Action Registration<span class="jss67"></span></a><a tabindex="-1" class="jss55 jss229 jss232 jss236 jss237 jss227 jss221 jss220" role="menuitem" href="/usages/status/">Status<span class="jss67"></span></a><a tabindex="-1" class="jss55 jss229 jss232 jss236 jss237 jss227 jss221 jss220" role="menuitem" href="/usages/conditions_assertions/">Conditions and assertions<span class="jss67"></span></a><a tabindex="-1" class="jss55 jss229 jss232 jss236 jss237 jss227 jss221 jss220" role="menuitem" href="/usages/events/">Events API<span class="jss67"></span></a><a tabindex="-1" class="jss55 jss229 jss232 jss236 jss237 jss227 jss221 jss220" role="menuitem" href="/usages/logging_debugging/">Logging and Debugging<span class="jss67"></span></a><a tabindex="-1" class="jss55 jss229 jss232 jss236 jss237 jss227 jss221 jss220" role="menuitem" href="/usages/control_flow/">Control Flow<span class="jss67"></span></a><a tabindex="-1" class="jss55 jss229 jss232 jss236 jss237 jss227 jss221 jss220" role="menuitem" href="/usages/error/">Error handling<span class="jss67"></span></a></ul></div></div></div></nav></div><div class="jss219"><nav class="jss223 jss224" role="menu"><li class="jss230"><a tabindex="-1" class="jss55 jss229 jss232 jss236 jss237 jss238 jss227" role="menuitem" href="/options/"><div class="jss240"><span class="jss74 jss81 jss243">Options</span></div><span class="jss67"></span></a><div class="jss246"><button tabindex="0" class="jss55 jss49" type="button"><span class="jss54"><svg class="jss58" focusable="false" viewBox="0 0 24 24" aria-hidden="true" role="presentation"><path d="M12 8l-6 6 1.41 1.41L12 10.83l4.59 4.58L18 14z"></path><path fill="none" d="M0 0h24v24H0z"></path></svg></span><span class="jss67"></span></button></div></li><div class="jss247 jss248" style="min-height:0px" tabindex="-1"><div class="jss249"><div class="jss250"><ul class="jss223" role="menu"><a tabindex="-1" class="jss55 jss229 jss232 jss236 jss237 jss227 jss221 jss220" role="menuitem" href="/options/once/">Option &quot;once&quot;<span class="jss67"></span></a><a tabindex="-1" class="jss55 jss229 jss232 jss236 jss237 jss227 jss221 jss220" role="menuitem" href="/options/attempt/">Option &quot;attempt&quot;<span class="jss67"></span></a><a tabindex="-1" class="jss55 jss229 jss232 jss236 jss237 jss227 jss221 jss220" role="menuitem" href="/options/debug/">Option &quot;debug&quot;<span class="jss67"></span></a><a tabindex="-1" class="jss55 jss229 jss232 jss236 jss237 jss227 jss221 jss220" role="menuitem" href="/options/handler/">Option &quot;handler&quot;<span class="jss67"></span></a><a tabindex="-1" class="jss55 jss229 jss232 jss236 jss237 jss227 jss221 jss220" role="menuitem" href="/options/header/">Option &quot;header&quot;<span class="jss67"></span></a><a tabindex="-1" class="jss55 jss229 jss232 jss236 jss237 jss227 jss221 jss220" role="menuitem" href="/options/cascade/">Option &quot;cascade&quot;<span class="jss67"></span></a><a tabindex="-1" class="jss55 jss229 jss232 jss236 jss237 jss227 jss221 jss220" role="menuitem" href="/options/relax/">Option &quot;relax&quot;<span class="jss67"></span></a><a tabindex="-1" class="jss55 jss229 jss232 jss236 jss237 jss227 jss221 jss220" role="menuitem" href="/options/retry/">Option &quot;retry&quot;<span class="jss67"></span></a><a tabindex="-1" class="jss55 jss229 jss232 jss236 jss237 jss227 jss221 jss220" role="menuitem" href="/options/shy/">Option &quot;shy&quot;<span class="jss67"></span></a><a tabindex="-1" class="jss55 jss229 jss232 jss236 jss237 jss227 jss221 jss220" role="menuitem" href="/options/sleep/">Option &quot;sleep&quot;<span class="jss67"></span></a><a tabindex="-1" class="jss55 jss229 jss232 jss236 jss237 jss227 jss221 jss220" role="menuitem" href="/options/sudo/">Option &quot;sudo&quot;<span class="jss67"></span></a></ul></div></div></div></nav></div><span class="jss74 jss84 jss214">Help us<!-- --> <a href="https://github.com/adaltas/node-nikita-docs/issues" target="_blank" rel="noopener">improve the docs</a> <!-- -->by fixing typos and proposing enhancements.</span></div></div></div></div></div><script>
  
  
  if(true) {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  }
  if (typeof ga === "function") {
    ga('create', 'UA-1322093-4', 'auto', {});
      
      }
      </script><script id="gatsby-script-loader">/*<![CDATA[*/window.page={"componentChunkName":"component---src-templates-template-js","jsonName":"about-tutorial-ef9","path":"/about/tutorial/"};window.dataPath="622/path---about-tutorial-ef-9-ee9-Zec8UUI5Jagwcq61N6DFOm4V8";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"app":["/app-81426d799bfa5e36a8dc.js"],"component---node-modules-gatsby-plugin-offline-app-shell-js":["/component---node-modules-gatsby-plugin-offline-app-shell-js-112d9d28403b387fbfe3.js"],"component---src-templates-template-js":["/component---src-templates-template-js-7b0e122e1339e36ee047.js"],"component---src-pages-404-js":["/component---src-pages-404-js-58f3eaababfc33842a62.js"],"component---src-pages-index-js":["/component---src-pages-index-js-78509787aaf2bf44a0bd.js"]};/*]]>*/</script><script src="/webpack-runtime-cfdb1e99316333a36b8d.js" async=""></script><script src="/0-d91fd67f8e6efc633636.js" async=""></script><script src="/app-81426d799bfa5e36a8dc.js" async=""></script><script src="/component---src-templates-template-js-7b0e122e1339e36ee047.js" async=""></script><script src="/1-a9b23d1071238c1862cc.js" async=""></script></body></html>